Cubique=function(a){for(var b in a){this[b]=a[b]}this.count=0;this.currPage=1;this.sort="";this.search={};var c=[10,25,50,100];c.push(this.rowsOnPage);c.sort(function(a,b){return a-b});c.join();this.perPageOptions={};for(var d in c){this.perPageOptions[c[d]]=c[d]}this.renderGrid();this.showData()};Cubique.prototype.renderGrid=function a(){var a='<table class="cubique"><thead><tr>';var b="";for(var c in this.columns){if(typeof this.columnsToSort[c]!="undefined"){b='<span></span> <a href="#" class="sort-by" sort-column="'+c+'" sort-rotation="ASC">'+this.columns[c]+"</a>"}else{b=this.columns[c]}a+="<th>"+b+"</th>"}a+="</tr>";if(Object.size(this.columnsToSearch)){a+="<tr>";for(var d in this.columns){if(typeof this.columnsToSearch[d]!="undefined"){b='<input type="text" search-column="'+d+'"/>'}else{b=""}a+="<th>"+b+"</th>"}a+="</tr>"}a+="</thead><tbody></tbody></table>";$("#cubique-"+this.name).html(a);var e="ASC";var f="";var g=this;$("#cubique-"+this.name+" a.sort-by").click(function(){$("#cubique-"+g.name+" a.sort-by").prev("span").html("");e=$(this).attr("sort-rotation");f=$(this).attr("sort-column");g.currPage=1;g.sort=f+" "+e;$(this).attr("sort-rotation",e=="ASC"?"DESC":"ASC");$(this).prev("span").html(e=="ASC"?"v":"^");g.showData();return false});$("#cubique-"+this.name+" input").keyup(function(){g.search[$(this).attr("search-column")]=$(this).val();g.currPage=1;g.showData();return false});this.tbody=$("#cubique-"+this.name+" tbody")};Cubique.prototype.showData=function b(){var a=$('<tr><td colspan="'+Object.size(this.columns)+'" class="loading">'+'<img src="/helpers/img/cubique_loading.gif"/></td></tr>');this.tbody.html(a);var b=this;$.ajax({type:"post",data:{cubique_grid_name:b.name,cubique_grid_curr_page:b.currPage,cubique_grid_sort:b.sort,cubique_grid_search:b.search,cubique_grid_rows_on_page:b.rowsOnPage},url:b.url?b.url:location.href,dataType:"json",success:function(c){if(c.error){alert("Error has been occurred. Try to refresh the page.")}else{b.count=c.count;var d="";for(var e in c.data){d+="<tr>";for(var f in c.data[e]){d+="<td>"+c.data[e][f]+"</td>"}d+="</tr>"}b.tbody.html(d);b.renderPagesSection()}a.remove()}})};Cubique.prototype.renderPagesSection=function c(){var a="";var b="";var c=Math.ceil(this.count/this.rowsOnPage);var d=1;var e=c;if(c>20){if(this.currPage<=10){d=1;e=20}else{d=this.currPage-9;e=this.currPage+10<=c?this.currPage+10:c;a+='<a href="#" class="go-to-page" page-number="1">1</a>...'}}for(var f=d;f<=e;f++){b=f==this.currPage?" curr":"";a+='<a href="#" class="go-to-page'+b+'" page-number="'+f+'">'+f+"</a>"}if(c>e){a+='...<a href="#" class="go-to-page" page-number="'+c+'">'+c+"</a>"}var g='<select class="per-page">';for(var f in this.perPageOptions){g+='<option value="'+this.perPageOptions[f]+'">'+this.perPageOptions[f]+"</option>"}g+="</select>";var h='<tr><th colspan="'+Object.size(this.columns)+'">'+a+g+'<span class="in-total">'+this.count+" in total</span></th></tr>";this.tbody.append(h);this.tbody.find(".per-page").val(this.rowsOnPage);var i=this;this.tbody.find(".go-to-page").click(function(){i.currPage=parseInt($(this).attr("page-number"));i.showData();return false});this.tbody.find(".per-page").change(function(){i.rowsOnPage=$(this).val();i.currPage=1;i.showData();return false})};Object.size=function(a){var b=0;for(var c in a){if(a.hasOwnProperty(c))b++}return b}